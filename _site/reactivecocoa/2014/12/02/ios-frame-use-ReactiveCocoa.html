<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>ReactiveCocoa 1-官方readme文档翻译</title>
   <meta name="author" content="Tom Preston-Werner" />
   <link href="http://feeds.feedburner.com/tom-preston-werner" rel="alternate" title="Tom Preston-Werner" type="application/atom+xml" />
   <meta name="readability-verification" content="QCzSs992GxmRYRKVpPeZ6LE2tS8aYKxsSSQKV8YM"/>

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />

   <!-- Typekit -->
   <script type="text/javascript" src="http://use.typekit.com/jpd0pfm.js"></script>
   <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body>

<!-- ClickTale Top part -->
<script type="text/javascript">
var WRInitTime=(new Date()).getTime();
</script>
<!-- ClickTale end of Top part -->

<div class="site">
  <div class="title">
    <a href="/">Di Daily-Blog</a>
    <a class="extra" href="/">home</a>
  </div>

  <div id="post">
<h2 id="前言">前言</h2>
<blockquote>
  <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>说起ReactiveCocoa，必须要先了解mvvm模式，与常规的mvc模式的区别
但是说的很简单，看了两天后，感觉大概懂了。但是还是不会用。
所以开始前，我先尝试翻译下github上ReactiveCocoa的readme。
英语能力不好，请大家多包涵。
</code></pre></div>  </div>
</blockquote>

<h2 id="原文地址">原文地址</h2>
<p><a href="https://github.com/ReactiveCocoa/ReactiveCocoa#reactivecocoa">ReactiveCocoa readme原文地址</a></p>

<h2 id="开始翻译">开始翻译</h2>

<h1 id="reactivecocoa">ReactiveCocoa</h1>

<p>ReactiveCocoa (RAC)是由 <a href="http://en.wikipedia.org/wiki/Functional_reactive_programming">函数式响应编程</a> 灵感而来的ob-c框架. 框架为<strong>合成和转化价值流</strong>提供API接口。</p>

<p>如果你已经熟悉了函数式响应编程或者了解了基本的ReactiveCocoa理论，请下载 <a href="https://github.com/ReactiveCocoa/ReactiveCocoa/blob/master/Documentation">文档</a> 文件夹下的预览和了解更多实际应用中的深入解析。</p>

<h2 id="发现新的reactivecocoa">发现新的ReactiveCocoa?</h2>

<p>ReactiveCocoa被疯狂的记录，并且这里有丰富的介绍材料来解释你RAC是什么以及你如何使用它。</p>

<p>如果你想了解更多，我们建议阅读下面几条：</p>

<ol>
  <li><a href="#简介">简介</a></li>
  <li><a href="#使用场景">使用场景</a></li>
  <li><a href="https://github.com/ReactiveCocoa/ReactiveCocoa/blob/master/Documentation/FrameworkOverview.md">框架预览</a></li>
  <li><a href="https://github.com/ReactiveCocoa/ReactiveCocoa/blob/master/Documentation/BasicOperators.md">基本操作</a></li>
  <li><a href="https://github.com/ReactiveCocoa/ReactiveCocoa/blob/master/ReactiveCocoaFramework/ReactiveCocoa">头文件</a></li>
  <li>以前的回答 <a href="https://github.com/ReactiveCocoa/ReactiveCocoa/wiki">Stack Overflow</a>
问题 和 <a href="https://github.com/ReactiveCocoa/ReactiveCocoa/issues?labels=question&amp;state=closed">GitHub issues</a></li>
  <li>最近 <a href="https://github.com/ReactiveCocoa/ReactiveCocoa/tree/master/Documentation">文档</a></li>
  <li><a href="https://leanpub.com/iosfrp/">ios函数式响应编程</a> 
(eBook)</li>
</ol>

<p>如果你有任何问题欢迎提问：<a href="https://github.com/ReactiveCocoa/ReactiveCocoa/issues/new">file an issue</a>.</p>

<h2 id="简介">简介</h2>

<p>ReactiveCocoa是由<a href="http://blog.maybeapps.com/post/42894317939/input-and-output">函数式响应编程</a>灵感而来.
RAC提供了信号量的概念用于捕捉当前和未来变量值的变化，而不是使用手动替换或者修改变量时再对应修改对应的变量值。</p>

<p>RAC不需要通过代码去持续的观察和更新变量值，而是通过一系列的链接(chaining)，结合(combining)，和响应信号(sigles)去重写和声明变量。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>例如：一个UITextField被声明后，一旦它发生改变，RAC不会通过传统的每时每刻检测和更新UITextField，而是通过类似KVO的方式，使用blocks的方式取代传统的`-observeValueForKeyPath:ofObject:change:context:`方式。
</code></pre></div></div>

<p>信号也可以表示异步操作，就像<a href="http://en.wikipedia.org/wiki/Futures_and_promises">futures and promises</a>。这大大简化了异步软件，包括网络代码。
一个RAC的主要优点是它提供了一个单一的，统一的方法来处理异步行为，包括委托的回调方法，块，目标的行动机制，通知，并保持程序通畅。</p>

<p>下面时一个例子:</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">// 当self.username发生变化, 打印变化信息到控制台.
//
// RACObserve(self, username)建立一个信号，不论self.username任何时候发生变化时，都会传递回来.
// 每当信号发送一个值 -subscribeNext: 将执行block解析这个值.
</span><span class="p">[</span><span class="n">RACObserve</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span> <span class="nf">subscribeNext</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">newName</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">NSLog</span><span class="p">(</span><span class="s">@"%@"</span><span class="p">,</span> <span class="n">newName</span><span class="p">);</span>
<span class="p">}];</span></code></pre></figure>

<p>但是不像KVO notifications，信号可以串联在一块执行：</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">// 只有开头有"j"是才打印
//
// -filter returns a new RACSignal that only sends a new value when its block
// returns YES.
</span><span class="p">[[</span><span class="n">RACObserve</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
	<span class="nf">filter</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">newName</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="p">[</span><span class="n">newName</span> <span class="nf">hasPrefix</span><span class="p">:</span><span class="s">@"j"</span><span class="p">];</span>
	<span class="p">}]</span>
	<span class="nf">subscribeNext</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">newName</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">NSLog</span><span class="p">(</span><span class="s">@"%@"</span><span class="p">,</span> <span class="n">newName</span><span class="p">);</span>
	<span class="p">}];</span></code></pre></figure>

<p>信号也可以是用来推导出状态。不需要不断的观察和另外验证信息，RAC可以用于输出信号和对信号进行验证操作：</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">//创建一个单向针对self.createEnabled的绑定，如果两次密码一致时，返回true
//
// RAC() 很擅长让绑定结合看起来更好
// 
// +combineLatest:reduce: 可以针对不定时变更的信号量数组进行处理，并返回一个block处理过的新的信号量
</span>
<span class="n">RAC</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">createEnabled</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="n">RACSignal</span> 
	<span class="nf">combineLatest</span><span class="p">:@[</span> <span class="n">RACObserve</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">password</span><span class="p">),</span> <span class="n">RACObserve</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">passwordConfirmation</span><span class="p">)</span> <span class="p">]</span> 
	<span class="nf">reduce</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">password</span><span class="p">,</span> <span class="n">NSString</span> <span class="o">*</span><span class="n">passwordConfirm</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="err">@</span><span class="p">([</span><span class="n">passwordConfirm</span> <span class="nf">isEqualToString</span><span class="p">:</span><span class="n">password</span><span class="p">]);</span>
	<span class="p">}];</span></code></pre></figure>

<p>信号量可以建立随时间变化的变量值，不仅仅针对KVO,例如：</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">// Logs a message whenever the button is pressed.
//
// RACCommand creates signals to represent UI actions. Each signal can
// represent a button press, for example, and have additional work associated
// with it.
//
// -rac_command is an addition to NSButton. The button will send itself on that
// command whenever it's pressed.
</span><span class="n">self</span><span class="p">.</span><span class="n">button</span><span class="p">.</span><span class="n">rac_command</span> <span class="o">=</span> <span class="p">[[</span><span class="n">RACCommand</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithSignalBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">id</span> <span class="n">_</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">NSLog</span><span class="p">(</span><span class="s">@"button was pressed!"</span><span class="p">);</span>
	<span class="k">return</span> <span class="p">[</span><span class="n">RACSignal</span> <span class="nf">empty</span><span class="p">];</span>
<span class="p">}];</span></code></pre></figure>

<p>或者是针对异步的网络请求：</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">// Hooks up a "Log in" button to log in over the network.
//
// This block will be run whenever the login command is executed, starting
// the login process.
</span><span class="n">self</span><span class="p">.</span><span class="n">loginCommand</span> <span class="o">=</span> <span class="p">[[</span><span class="n">RACCommand</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithSignalBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">id</span> <span class="n">sender</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// The hypothetical -logIn method returns a signal that sends a value when
</span>	<span class="c1">// the network request finishes.
</span>	<span class="k">return</span> <span class="p">[</span><span class="n">client</span> <span class="nf">logIn</span><span class="p">];</span>
<span class="p">}];</span>

<span class="c1">// -executionSignals returns a signal that includes the signals returned from
// the above block, one for each time the command is executed.
</span><span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">loginCommand</span><span class="p">.</span><span class="n">executionSignals</span> <span class="nf">subscribeNext</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">RACSignal</span> <span class="o">*</span><span class="n">loginSignal</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// Log a message whenever we log in successfully.
</span>	<span class="p">[</span><span class="n">loginSignal</span> <span class="nf">subscribeCompleted</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
		<span class="n">NSLog</span><span class="p">(</span><span class="s">@"Logged in successfully!"</span><span class="p">);</span>
	<span class="p">}];</span>
<span class="p">}];</span>

<span class="c1">// Executes the login command when the button is pressed.
</span><span class="n">self</span><span class="p">.</span><span class="n">loginButton</span><span class="p">.</span><span class="n">rac_command</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">loginCommand</span><span class="p">;</span></code></pre></figure>

<p>信号也可以代表其他用户界面事件，定时器，或随时间改变的任何事情。</p>

<p>使用异步的信号操作可以通过链式和转换信号建立更加灵活的行为。可以让一系列操作完成后更加容易出发后续操作：</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">// Performs 2 network operations and logs a message to the console when they are
// both completed.
//
// +merge: takes an array of signals and returns a new RACSignal that passes
// through the values of all of the signals and completes when all of the
// signals complete.
//
// -subscribeCompleted: will execute the block when the signal completes.
</span><span class="p">[[</span><span class="n">RACSignal</span> 
	<span class="nf">merge</span><span class="p">:@[</span> <span class="p">[</span><span class="n">client</span> <span class="nf">fetchUserRepos</span><span class="p">],</span> <span class="p">[</span><span class="n">client</span> <span class="nf">fetchOrgRepos</span><span class="p">]</span> <span class="p">]]</span> 
	<span class="nf">subscribeCompleted</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
		<span class="n">NSLog</span><span class="p">(</span><span class="s">@"They're both done!"</span><span class="p">);</span>
	<span class="p">}];</span></code></pre></figure>

<p>信号可以被顺序执行异步操作，而不是嵌套使用块.这类似于<a href="http://en.wikipedia.org/wiki/Futures_and_promises">futures and promises</a>工作机制：</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">// Logs in the user, then loads any cached messages, then fetches the remaining
// messages from the server. After that's all done, logs a message to the
// console.
//
// The hypothetical -logInUser methods returns a signal that completes after
// logging in.
//
// -flattenMap: will execute its block whenever the signal sends a value, and
// returns a new RACSignal that merges all of the signals returned from the block
// into a single signal.
</span><span class="p">[[[[</span><span class="n">client</span> 
	<span class="nf">logInUser</span><span class="p">]</span> 
	<span class="nf">flattenMap</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">User</span> <span class="o">*</span><span class="n">user</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// Return a signal that loads cached messages for the user.
</span>		<span class="k">return</span> <span class="p">[</span><span class="n">client</span> <span class="nf">loadCachedMessagesForUser</span><span class="p">:</span><span class="n">user</span><span class="p">];</span>
	<span class="p">}]</span>
	<span class="nf">flattenMap</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">messages</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// Return a signal that fetches any remaining messages.
</span>		<span class="k">return</span> <span class="p">[</span><span class="n">client</span> <span class="nf">fetchMessagesAfterMessage</span><span class="p">:</span><span class="n">messages</span><span class="p">.</span><span class="n">lastObject</span><span class="p">];</span>
	<span class="p">}]</span>
	<span class="nf">subscribeNext</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">newMessages</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">NSLog</span><span class="p">(</span><span class="s">@"New messages: %@"</span><span class="p">,</span> <span class="n">newMessages</span><span class="p">);</span>
	<span class="p">}</span> <span class="nf">completed</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
		<span class="n">NSLog</span><span class="p">(</span><span class="s">@"Fetched all messages."</span><span class="p">);</span>
	<span class="p">}];</span></code></pre></figure>

<p>RAC甚至可以使异步操作的结果更容易被绑定：</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">// Creates a one-way binding so that self.imageView.image will be set the user's
// avatar as soon as it's downloaded.
//
// The hypothetical -fetchUserWithUsername: method returns a signal which sends
// the user.
//
// -deliverOn: creates new signals that will do their work on other queues. In
// this example, it's used to move work to a background queue and then back to the main thread.
//
// -map: calls its block with each user that's fetched and returns a new
// RACSignal that sends values returned from the block.
</span><span class="n">RAC</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">imageView</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span> <span class="o">=</span> <span class="p">[[[[</span><span class="n">client</span> 
	<span class="nf">fetchUserWithUsername</span><span class="p">:</span><span class="s">@"joshaber"</span><span class="p">]</span>
	<span class="nf">deliverOn</span><span class="p">:[</span><span class="n">RACScheduler</span> <span class="nf">scheduler</span><span class="p">]]</span>
	<span class="nf">map</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">User</span> <span class="o">*</span><span class="n">user</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// Download the avatar (this is done on a background queue).
</span>		<span class="k">return</span> <span class="p">[[</span><span class="n">NSImage</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithContentsOfURL</span><span class="p">:</span><span class="n">user</span><span class="p">.</span><span class="n">avatarURL</span><span class="p">];</span>
	<span class="p">}]</span>
	<span class="c1">// Now the assignment will be done on the main thread.
</span>	<span class="nl">deliverOn:</span><span class="n">RACScheduler</span><span class="p">.</span><span class="nf">mainThreadScheduler</span><span class="p">];</span></code></pre></figure>

<p>That demonstrates some of what RAC can do, but it doesn’t demonstrate why RAC is
so powerful. It’s hard to appreciate RAC from README-sized examples, but it
makes it possible to write code with less state, less boilerplate, better code
locality, and better expression of intent.</p>

<p>这表明，RAC可以做些什么，但这并不说明为什么RAC如此强大。欣赏RAC自述文件大小的例子，是很难的，但它可以用较少的状态，写更少的代码模板，更好的代码的地方，和更好的表达意图。</p>

<p>寻找更多的实际代码，可以查看 <a href="https://github.com/AshFurrow/C-41">C-41</a> 或者 <a href="https://github.com/jspahrsummers/GroceryList">GroceryList</a>,他们都是使用ReactiveCocoa编写的ios app。</p>

<h2 id="使用场景">使用场景</h2>

<p>乍一看，reactivecocoa是很抽象的，它可能很难了解如何将它应用到具体的问题。</p>

<p>下面使可以使用RAC的场景展示：</p>

<h3 id="处理异步或事件驱动的数据源">处理异步或事件驱动的数据源</h3>

<p>Cocoa编程的重点是用户的事件或变化的反应应用程序状态。这样的事件处理代码就会变得很复杂的并且代码很冗长，用回调和状态变量的大量处理排序问题。</p>

<p>看起来不同的模式，如UI回调，网络响应，而KVO通知，实际上有很多共同之处。<a href="https://github.com/ReactiveCocoa/ReactiveCocoa/blob/master/ReactiveCocoaFramework/ReactiveCocoa/RACSignal.h">racsignal</a>结合所有这些不同的API，这样他们可以组合在一起，相同的方式操纵。</p>

<p>例如下面的代码</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="k">static</span> <span class="kt">void</span> <span class="o">*</span><span class="n">ObservationContext</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ObservationContext</span><span class="p">;</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">viewDidLoad</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">super</span> <span class="nf">viewDidLoad</span><span class="p">];</span>

	<span class="p">[</span><span class="n">LoginManager</span><span class="p">.</span><span class="n">sharedManager</span> <span class="nf">addObserver</span><span class="p">:</span><span class="n">self</span> <span class="nf">forKeyPath</span><span class="p">:</span><span class="s">@"loggingIn"</span> <span class="n">options</span><span class="o">:</span><span class="n">NSKeyValueObservingOptionInitial</span> <span class="n">context</span><span class="o">:&amp;</span><span class="n">ObservationContext</span><span class="p">];</span>
	<span class="p">[</span><span class="n">NSNotificationCenter</span><span class="p">.</span><span class="n">defaultCenter</span> <span class="nf">addObserver</span><span class="p">:</span><span class="n">self</span> <span class="nf">selector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">loggedOut</span><span class="o">:</span><span class="p">)</span> <span class="n">name</span><span class="o">:</span><span class="n">UserDidLogOutNotification</span> <span class="n">object</span><span class="o">:</span><span class="n">LoginManager</span><span class="p">.</span><span class="n">sharedManager</span><span class="p">];</span>

	<span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">usernameTextField</span> <span class="nf">addTarget</span><span class="p">:</span><span class="n">self</span> <span class="nf">action</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">updateLogInButton</span><span class="p">)</span> <span class="n">forControlEvents</span><span class="o">:</span><span class="n">UIControlEventEditingChanged</span><span class="p">];</span>
	<span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">passwordTextField</span> <span class="nf">addTarget</span><span class="p">:</span><span class="n">self</span> <span class="nf">action</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">updateLogInButton</span><span class="p">)</span> <span class="n">forControlEvents</span><span class="o">:</span><span class="n">UIControlEventEditingChanged</span><span class="p">];</span>
	<span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">logInButton</span> <span class="nf">addTarget</span><span class="p">:</span><span class="n">self</span> <span class="nf">action</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">logInPressed</span><span class="o">:</span><span class="p">)</span> <span class="n">forControlEvents</span><span class="o">:</span><span class="n">UIControlEventTouchUpInside</span><span class="p">];</span>
<span class="p">}</span>

<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">dealloc</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">LoginManager</span><span class="p">.</span><span class="n">sharedManager</span> <span class="nf">removeObserver</span><span class="p">:</span><span class="n">self</span> <span class="nf">forKeyPath</span><span class="p">:</span><span class="s">@"loggingIn"</span> <span class="n">context</span><span class="o">:</span><span class="n">ObservationContext</span><span class="p">];</span>
	<span class="p">[</span><span class="n">NSNotificationCenter</span><span class="p">.</span><span class="n">defaultCenter</span> <span class="nf">removeObserver</span><span class="p">:</span><span class="n">self</span><span class="p">];</span>
<span class="p">}</span>

<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">updateLogInButton</span> <span class="p">{</span>
	<span class="n">BOOL</span> <span class="n">textFieldsNonEmpty</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">usernameTextField</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">self</span><span class="p">.</span><span class="n">passwordTextField</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">BOOL</span> <span class="n">readyToLogIn</span> <span class="o">=</span> <span class="o">!</span><span class="n">LoginManager</span><span class="p">.</span><span class="n">sharedManager</span><span class="p">.</span><span class="n">isLoggingIn</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">self</span><span class="p">.</span><span class="n">loggedIn</span><span class="p">;</span>
	<span class="n">self</span><span class="p">.</span><span class="n">logInButton</span><span class="p">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="n">textFieldsNonEmpty</span> <span class="o">&amp;&amp;</span> <span class="n">readyToLogIn</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">-</span> <span class="p">(</span><span class="n">IBAction</span><span class="p">)</span><span class="n">logInPressed</span><span class="o">:</span><span class="p">(</span><span class="n">UIButton</span> <span class="o">*</span><span class="p">)</span><span class="n">sender</span> <span class="p">{</span>
	<span class="p">[[</span><span class="n">LoginManager</span> <span class="nf">sharedManager</span><span class="p">]</span>
		<span class="nf">logInWithUsername</span><span class="p">:</span><span class="n">self</span><span class="p">.</span><span class="n">usernameTextField</span><span class="p">.</span><span class="n">text</span>
		<span class="nf">password</span><span class="p">:</span><span class="n">self</span><span class="p">.</span><span class="n">passwordTextField</span><span class="p">.</span><span class="n">text</span>
		<span class="n">success</span><span class="o">:^</span><span class="p">{</span>
			<span class="n">self</span><span class="p">.</span><span class="n">loggedIn</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">failure</span><span class="o">:^</span><span class="p">(</span><span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
			<span class="p">[</span><span class="n">self</span> <span class="nf">presentError</span><span class="p">:</span><span class="n">error</span><span class="p">];</span>
		<span class="p">}];</span>
<span class="p">}</span>

<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">loggedOut</span><span class="o">:</span><span class="p">(</span><span class="n">NSNotification</span> <span class="o">*</span><span class="p">)</span><span class="n">notification</span> <span class="p">{</span>
	<span class="n">self</span><span class="p">.</span><span class="n">loggedIn</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">observeValueForKeyPath</span><span class="o">:</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">keyPath</span> <span class="n">ofObject</span><span class="o">:</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="n">object</span> <span class="n">change</span><span class="o">:</span><span class="p">(</span><span class="n">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="n">change</span> <span class="n">context</span><span class="o">:</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">context</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">context</span> <span class="o">==</span> <span class="n">ObservationContext</span><span class="p">)</span> <span class="p">{</span>
		<span class="p">[</span><span class="n">self</span> <span class="nf">updateLogInButton</span><span class="p">];</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="p">[</span><span class="n">super</span> <span class="nf">observeValueForKeyPath</span><span class="p">:</span><span class="n">keyPath</span> <span class="nf">ofObject</span><span class="p">:</span><span class="n">object</span> <span class="n">change</span><span class="o">:</span><span class="n">change</span> <span class="n">context</span><span class="o">:</span><span class="n">context</span><span class="p">];</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>… 转换成RAC写法：</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">viewDidLoad</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">super</span> <span class="nf">viewDidLoad</span><span class="p">];</span>

	<span class="err">@weakify</span><span class="p">(</span><span class="n">self</span><span class="p">);</span>

	<span class="n">RAC</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">logInButton</span><span class="p">,</span> <span class="n">enabled</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="n">RACSignal</span>
		<span class="nf">combineLatest</span><span class="p">:@[</span>
			<span class="n">self</span><span class="p">.</span><span class="n">usernameTextField</span><span class="p">.</span><span class="n">rac_textSignal</span><span class="p">,</span>
			<span class="n">self</span><span class="p">.</span><span class="n">passwordTextField</span><span class="p">.</span><span class="n">rac_textSignal</span><span class="p">,</span>
			<span class="n">RACObserve</span><span class="p">(</span><span class="n">LoginManager</span><span class="p">.</span><span class="n">sharedManager</span><span class="p">,</span> <span class="n">loggingIn</span><span class="p">),</span>
			<span class="n">RACObserve</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">loggedIn</span><span class="p">)</span>
		<span class="p">]</span> <span class="nf">reduce</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">username</span><span class="p">,</span> <span class="n">NSString</span> <span class="o">*</span><span class="n">password</span><span class="p">,</span> <span class="n">NSNumber</span> <span class="o">*</span><span class="n">loggingIn</span><span class="p">,</span> <span class="n">NSNumber</span> <span class="o">*</span><span class="n">loggedIn</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="err">@</span><span class="p">(</span><span class="n">username</span><span class="p">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">password</span><span class="p">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">loggingIn</span><span class="p">.</span><span class="n">boolValue</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">loggedIn</span><span class="p">.</span><span class="n">boolValue</span><span class="p">);</span>
		<span class="p">}];</span>

	<span class="p">[[</span><span class="n">self</span><span class="p">.</span><span class="n">logInButton</span> <span class="nf">rac_signalForControlEvents</span><span class="p">:</span><span class="n">UIControlEventTouchUpInside</span><span class="p">]</span> <span class="nf">subscribeNext</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">UIButton</span> <span class="o">*</span><span class="n">sender</span><span class="p">)</span> <span class="p">{</span>
		<span class="err">@strongify</span><span class="p">(</span><span class="n">self</span><span class="p">);</span>

		<span class="n">RACSignal</span> <span class="o">*</span><span class="n">loginSignal</span> <span class="o">=</span> <span class="p">[</span><span class="n">LoginManager</span><span class="p">.</span><span class="n">sharedManager</span>
			<span class="nf">logInWithUsername</span><span class="p">:</span><span class="n">self</span><span class="p">.</span><span class="n">usernameTextField</span><span class="p">.</span><span class="n">text</span>
			<span class="nf">password</span><span class="p">:</span><span class="n">self</span><span class="p">.</span><span class="n">passwordTextField</span><span class="p">.</span><span class="n">text</span><span class="p">];</span>

			<span class="p">[</span><span class="n">loginSignal</span> <span class="nf">subscribeError</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
				<span class="err">@strongify</span><span class="p">(</span><span class="n">self</span><span class="p">);</span>
				<span class="p">[</span><span class="n">self</span> <span class="nf">presentError</span><span class="p">:</span><span class="n">error</span><span class="p">];</span>
			<span class="p">}</span> <span class="nf">completed</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
				<span class="err">@strongify</span><span class="p">(</span><span class="n">self</span><span class="p">);</span>
				<span class="n">self</span><span class="p">.</span><span class="n">loggedIn</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
			<span class="p">}];</span>
	<span class="p">}];</span>

	<span class="n">RAC</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">loggedIn</span><span class="p">)</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSNotificationCenter</span><span class="p">.</span><span class="n">defaultCenter</span>
		<span class="nf">rac_addObserverForName</span><span class="p">:</span><span class="n">UserDidLogOutNotification</span> <span class="nf">object</span><span class="p">:</span><span class="nf">nil</span><span class="p">]</span>
		<span class="n">mapReplace</span><span class="o">:</span><span class="nb">@NO</span><span class="p">];</span>
<span class="p">}</span></code></pre></figure>

<h3 id="链接依赖操作">链接依赖操作</h3>

<p>相关依赖往往是在网络请求时体现，当下一步网络请求执行时，需要上一步的结构才可以，这样的例子还有很多：</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="p">[</span><span class="n">client</span> <span class="nf">logInWithSuccess</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
	<span class="p">[</span><span class="n">client</span> <span class="nf">loadCachedMessagesWithSuccess</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">messages</span><span class="p">)</span> <span class="p">{</span>
		<span class="p">[</span><span class="n">client</span> <span class="nf">fetchMessagesAfterMessage</span><span class="p">:</span><span class="n">messages</span><span class="p">.</span><span class="n">lastObject</span> <span class="nf">success</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">nextMessages</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">NSLog</span><span class="p">(</span><span class="s">@"Fetched all messages."</span><span class="p">);</span>
		<span class="p">}</span> <span class="n">failure</span><span class="o">:^</span><span class="p">(</span><span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
			<span class="p">[</span><span class="n">self</span> <span class="nf">presentError</span><span class="p">:</span><span class="n">error</span><span class="p">];</span>
		<span class="p">}];</span>
	<span class="p">}</span> <span class="nf">failure</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
		<span class="p">[</span><span class="n">self</span> <span class="nf">presentError</span><span class="p">:</span><span class="n">error</span><span class="p">];</span>
	<span class="p">}];</span>
<span class="p">}</span> <span class="nf">failure</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">self</span> <span class="nf">presentError</span><span class="p">:</span><span class="n">error</span><span class="p">];</span>
<span class="p">}];</span></code></pre></figure>

<p>ReactiveCocoa让这种模式变得简单:</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="p">[[[[</span><span class="n">client</span> <span class="nf">logIn</span><span class="p">]</span>
	<span class="nf">then</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
		<span class="k">return</span> <span class="p">[</span><span class="n">client</span> <span class="nf">loadCachedMessages</span><span class="p">];</span>
	<span class="p">}]</span>
	<span class="nf">flattenMap</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">messages</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="p">[</span><span class="n">client</span> <span class="nf">fetchMessagesAfterMessage</span><span class="p">:</span><span class="n">messages</span><span class="p">.</span><span class="n">lastObject</span><span class="p">];</span>
	<span class="p">}]</span>
	<span class="nf">subscribeError</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
		<span class="p">[</span><span class="n">self</span> <span class="nf">presentError</span><span class="p">:</span><span class="n">error</span><span class="p">];</span>
	<span class="p">}</span> <span class="nf">completed</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
		<span class="n">NSLog</span><span class="p">(</span><span class="s">@"Fetched all messages."</span><span class="p">);</span>
	<span class="p">}];</span></code></pre></figure>

<h3 id="并行独立工作">并行独立工作</h3>

<p>与独立的数据集的并行工作，然后把它们合并成一个最终的结果，往往涉及到很多的同步：</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="n">__block</span> <span class="n">NSArray</span> <span class="o">*</span><span class="n">databaseObjects</span><span class="p">;</span>
<span class="n">__block</span> <span class="n">NSArray</span> <span class="o">*</span><span class="n">fileContents</span><span class="p">;</span>
 
<span class="n">NSOperationQueue</span> <span class="o">*</span><span class="n">backgroundQueue</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSOperationQueue</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="n">NSBlockOperation</span> <span class="o">*</span><span class="n">databaseOperation</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSBlockOperation</span> <span class="nf">blockOperationWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
	<span class="n">databaseObjects</span> <span class="o">=</span> <span class="p">[</span><span class="n">databaseClient</span> <span class="nf">fetchObjectsMatchingPredicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">];</span>
<span class="p">}];</span>

<span class="n">NSBlockOperation</span> <span class="o">*</span><span class="n">filesOperation</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSBlockOperation</span> <span class="nf">blockOperationWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
	<span class="n">NSMutableArray</span> <span class="o">*</span><span class="n">filesInProgress</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableArray</span> <span class="nf">array</span><span class="p">];</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">path</span> <span class="k">in</span> <span class="n">files</span><span class="p">)</span> <span class="p">{</span>
		<span class="p">[</span><span class="n">filesInProgress</span> <span class="nf">addObject</span><span class="p">:[</span><span class="n">NSData</span> <span class="nf">dataWithContentsOfFile</span><span class="p">:</span><span class="n">path</span><span class="p">]];</span>
	<span class="p">}</span>

	<span class="n">fileContents</span> <span class="o">=</span> <span class="p">[</span><span class="n">filesInProgress</span> <span class="nf">copy</span><span class="p">];</span>
<span class="p">}];</span>
 
<span class="n">NSBlockOperation</span> <span class="o">*</span><span class="n">finishOperation</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSBlockOperation</span> <span class="nf">blockOperationWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
	<span class="p">[</span><span class="n">self</span> <span class="nf">finishProcessingDatabaseObjects</span><span class="p">:</span><span class="n">databaseObjects</span> <span class="nf">fileContents</span><span class="p">:</span><span class="n">fileContents</span><span class="p">];</span>
	<span class="n">NSLog</span><span class="p">(</span><span class="s">@"Done processing"</span><span class="p">);</span>
<span class="p">}];</span>
 
<span class="p">[</span><span class="n">finishOperation</span> <span class="nf">addDependency</span><span class="p">:</span><span class="n">databaseOperation</span><span class="p">];</span>
<span class="p">[</span><span class="n">finishOperation</span> <span class="nf">addDependency</span><span class="p">:</span><span class="n">filesOperation</span><span class="p">];</span>
<span class="p">[</span><span class="n">backgroundQueue</span> <span class="nf">addOperation</span><span class="p">:</span><span class="n">databaseOperation</span><span class="p">];</span>
<span class="p">[</span><span class="n">backgroundQueue</span> <span class="nf">addOperation</span><span class="p">:</span><span class="n">filesOperation</span><span class="p">];</span>
<span class="p">[</span><span class="n">backgroundQueue</span> <span class="nf">addOperation</span><span class="p">:</span><span class="n">finishOperation</span><span class="p">];</span></code></pre></figure>

<p>上面的代码可以清理和通过简单的构成信号优化：</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="n">RACSignal</span> <span class="o">*</span><span class="n">databaseSignal</span> <span class="o">=</span> <span class="p">[[</span><span class="n">databaseClient</span>
	<span class="nf">fetchObjectsMatchingPredicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">]</span>
	<span class="nf">subscribeOn</span><span class="p">:[</span><span class="n">RACScheduler</span> <span class="nf">scheduler</span><span class="p">]];</span>

<span class="n">RACSignal</span> <span class="o">*</span><span class="n">fileSignal</span> <span class="o">=</span> <span class="p">[</span><span class="n">RACSignal</span> <span class="nf">startEagerlyWithScheduler</span><span class="p">:[</span><span class="n">RACScheduler</span> <span class="nf">scheduler</span><span class="p">]</span> <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">id</span><span class="o">&lt;</span><span class="n">RACSubscriber</span><span class="o">&gt;</span> <span class="n">subscriber</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">NSMutableArray</span> <span class="o">*</span><span class="n">filesInProgress</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableArray</span> <span class="nf">array</span><span class="p">];</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">path</span> <span class="k">in</span> <span class="n">files</span><span class="p">)</span> <span class="p">{</span>
		<span class="p">[</span><span class="n">filesInProgress</span> <span class="nf">addObject</span><span class="p">:[</span><span class="n">NSData</span> <span class="nf">dataWithContentsOfFile</span><span class="p">:</span><span class="n">path</span><span class="p">]];</span>
	<span class="p">}</span>

	<span class="p">[</span><span class="n">subscriber</span> <span class="nf">sendNext</span><span class="p">:[</span><span class="n">filesInProgress</span> <span class="nf">copy</span><span class="p">]];</span>
	<span class="p">[</span><span class="n">subscriber</span> <span class="nf">sendCompleted</span><span class="p">];</span>
<span class="p">}];</span>

<span class="p">[[</span><span class="n">RACSignal</span>
	<span class="nf">combineLatest</span><span class="p">:@[</span> <span class="n">databaseSignal</span><span class="p">,</span> <span class="n">fileSignal</span> <span class="p">]</span>
	<span class="nf">reduce</span><span class="p">:</span><span class="o">^</span> <span class="n">id</span> <span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">databaseObjects</span><span class="p">,</span> <span class="n">NSArray</span> <span class="o">*</span><span class="n">fileContents</span><span class="p">)</span> <span class="p">{</span>
		<span class="p">[</span><span class="n">self</span> <span class="nf">finishProcessingDatabaseObjects</span><span class="p">:</span><span class="n">databaseObjects</span> <span class="nf">fileContents</span><span class="p">:</span><span class="n">fileContents</span><span class="p">];</span>
		<span class="k">return</span> <span class="nb">nil</span><span class="p">;</span>
	<span class="p">}]</span>
	<span class="n">subscribeCompleted</span><span class="o">:^</span><span class="p">{</span>
		<span class="n">NSLog</span><span class="p">(</span><span class="s">@"Done processing"</span><span class="p">);</span>
	<span class="p">}];</span></code></pre></figure>

<h3 id="简化采集转换">简化采集转换</h3>

<p>Higher-order functions like <code class="highlighter-rouge">map</code>, <code class="highlighter-rouge">filter</code>, <code class="highlighter-rouge">fold</code>/<code class="highlighter-rouge">reduce</code> are sorely missing
from Foundation, leading to loop-focused code like this:</p>

<p>高阶函数像<code class="highlighter-rouge">地图</code>，<code class="highlighter-rouge">滤波器</code>，<code class="highlighter-rouge">褶皱</code> / <code class="highlighter-rouge">减少</code>非常缺少基础，导致环聚焦这样的代码：</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="n">NSMutableArray</span> <span class="o">*</span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableArray</span> <span class="nf">array</span><span class="p">];</span>
<span class="k">for</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">str</span> <span class="k">in</span> <span class="n">strings</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="n">length</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">continue</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">NSString</span> <span class="o">*</span><span class="n">newString</span> <span class="o">=</span> <span class="p">[</span><span class="n">str</span> <span class="nf">stringByAppendingString</span><span class="p">:</span><span class="s">@"foobar"</span><span class="p">];</span>
	<span class="p">[</span><span class="n">results</span> <span class="nf">addObject</span><span class="p">:</span><span class="n">newString</span><span class="p">];</span>
<span class="p">}</span></code></pre></figure>

<p><a href="ReactiveCocoaFramework/ReactiveCocoa/RACSequence.h">RACSequence</a> 允许任何Cocoa collection在一个统一的声明的方式操纵：</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="n">RACSequence</span> <span class="o">*</span><span class="n">results</span> <span class="o">=</span> <span class="p">[[</span><span class="n">strings</span><span class="p">.</span><span class="n">rac_sequence</span>
	<span class="nf">filter</span><span class="p">:</span><span class="o">^</span> <span class="n">BOOL</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">str</span><span class="p">.</span><span class="n">length</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">;</span>
	<span class="p">}]</span>
	<span class="nf">map</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="p">[</span><span class="n">str</span> <span class="nf">stringByAppendingString</span><span class="p">:</span><span class="s">@"foobar"</span><span class="p">];</span>
	<span class="p">}];</span></code></pre></figure>

<h2 id="system-requirements不翻译">System Requirements(不翻译)</h2>

<p>ReactiveCocoa supports OS X 10.7+ and iOS 5.0+.</p>

<h2 id="importing-reactivecocoa不翻译">Importing ReactiveCocoa(不翻译)</h2>

<p>To add RAC to your application:</p>

<ol>
  <li>Add the ReactiveCocoa repository as a submodule of your application’s
repository.</li>
  <li>Run <code class="highlighter-rouge">script/bootstrap</code> from within the ReactiveCocoa folder.</li>
  <li>Drag and drop <code class="highlighter-rouge">ReactiveCocoaFramework/ReactiveCocoa.xcodeproj</code> into your
application’s Xcode project or workspace.</li>
  <li>On the “Build Phases” tab of your application target, add RAC to the “Link
Binary With Libraries” phase.
    <ul>
      <li><strong>On iOS</strong>, add <code class="highlighter-rouge">libReactiveCocoa-iOS.a</code>.</li>
      <li><strong>On OS X</strong>, add <code class="highlighter-rouge">ReactiveCocoa.framework</code>. RAC must also be added to any
“Copy Frameworks” build phase. If you don’t already have one, simply add
a “Copy Files” build phase and target the “Frameworks” destination.</li>
    </ul>
  </li>
  <li>Add <code class="highlighter-rouge">"$(BUILD_ROOT)/../IntermediateBuildFilesPath/UninstalledProducts/include"
$(inherited)</code> to the “Header Search Paths” build setting (this is only
necessary for archive builds, but it has no negative effect otherwise).</li>
  <li><strong>For iOS targets</strong>, add <code class="highlighter-rouge">-ObjC</code> to the “Other Linker Flags” build setting.</li>
  <li><strong>If you added RAC to a project (not a workspace)</strong>, you will also need to
add the appropriate RAC target to the “Target Dependencies” of your
application.</li>
</ol>

<p>If you would prefer to use <a href="http://cocoapods.org">CocoaPods</a>, there are some
<a href="https://github.com/CocoaPods/Specs/tree/master/Specs/ReactiveCocoa">ReactiveCocoa
podspecs</a> that
have been generously contributed by third parties.</p>

<p>To see a project already set up with RAC, check out <a href="https://github.com/AshFurrow/C-41">C-41</a> or <a href="https://github.com/jspahrsummers/GroceryList">GroceryList</a>,
which are real iOS apps written using ReactiveCocoa.</p>

<h2 id="standalone-development">Standalone Development</h2>

<p>If you’re working on RAC in isolation instead of integrating it into another project, you’ll want to open <code class="highlighter-rouge">ReactiveCocoaFramework/ReactiveCocoa.xcworkspace</code> and not the <code class="highlighter-rouge">.xcodeproj</code>.</p>

<h2 id="参考文献">参考文献</h2>

<p>ReactiveCocoa is based on .NET’s <a href="http://msdn.microsoft.com/en-us/data/gg577609">Reactive
Extensions</a> (Rx). Most of the
principles of Rx apply to RAC as well. There are some really good Rx resources
out there:</p>

<ul>
  <li><a href="http://msdn.microsoft.com/en-us/library/hh242985.aspx">Reactive Extensions MSDN entry</a></li>
  <li><a href="http://leecampbell.blogspot.com/2010/08/reactive-extensions-for-net.html">Reactive Extensions for .NET Introduction</a></li>
  <li><a href="http://channel9.msdn.com/tags/Rx/">Rx - Channel 9 videos</a></li>
  <li><a href="http://rxwiki.wikidot.com/">Reactive Extensions wiki</a></li>
  <li><a href="http://rxwiki.wikidot.com/101samples">101 Rx Samples</a></li>
  <li><a href="http://www.amazon.com/Programming-Reactive-Extensions-Jesse-Liberty/dp/1430237473">Programming Reactive Extensions and LINQ</a></li>
</ul>

<p>RAC and Rx are both frameworks inspired by functional reactive programming. Here 
are some resources related to FRP:</p>

<ul>
  <li><a href="http://elm-lang.org/learn/What-is-FRP.elm">What is FRP? - Elm Language</a></li>
  <li><a href="http://stackoverflow.com/questions/1028250/what-is-functional-reactive-programming/1030631#1030631">What is Functional Reactive Programming - Stack Overflow</a></li>
  <li><a href="http://stackoverflow.com/questions/5875929/specification-for-a-functional-reactive-programming-language#5878525">Specification for a Functional Reactive Language - Stack Overflow</a></li>
  <li><a href="http://elm-lang.org/learn/Escape-from-Callback-Hell.elm">Escape from Callback Hell</a></li>
  <li><a href="https://www.coursera.org/course/reactive">Principles of Reactive Programming on Coursera</a></li>
</ul>


</div>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>15 Apr 2019</span> &raquo; <a href="/2019/04/15/begin.html">如何看待系统的稳定性</a></li>
    
      <li><span>02 Jan 2016</span> &raquo; <a href="/shaodu/2016/01/02/my-story-mom-author.html">90后儿子写60后老妈的故事-微信订阅号"少读"</a></li>
    
      <li><span>19 Sep 2015</span> &raquo; <a href="/pm/2015/09/19/my-tech-pm-review.html">个人技术辅助工具及产品经理工具集合(持续完善)</a></li>
    
  </ul>
</div>

  <div class="footer">
    <div class="contact">
      <p>
        Di Daily-Blog
        <br />
        Connect Me
          <!-- <a href="https://codestarter.org/">Codestarter</a>, -->
          <a href="https://github.com/icindy">GitHub Page</a>
        <br />
        uestc.zhangdi@gmail.com
      </p>
    </div>
    <div class="contact">
      <p>
        <a href="http://github.com/icindy/">github.com/icindy</a><br />
        <a href="http://twitter.com/di/">twitter.com/di</a><br />
      </p>
    </div>
    <div class="rss">
      <a href="http://feeds.feedburner.com/tom-preston-werner">
        <img src="/images/rss.png" alt="Subscribe to RSS Feed" />
      </a>
    </div>
  </div>
</div>

<a href="http://github.com/icindy"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" /></a>

<!-- ClickTale Bottom part -->
<div id="ClickTaleDiv" style="display: none;"></div>
<script type="text/javascript">
if(document.location.protocol!='https:')
  document.write(unescape("%3Cscript%20src='http://s.clicktale.net/WRb.js'%20type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
if(typeof ClickTale=='function') ClickTale(206,0.3,"www03");
</script>
<!-- ClickTale end of Bottom part -->

<!-- Google Analytics -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-6016902-1");
pageTracker._trackPageview();
</script>
<!-- Google Analytics end -->

</body>
</html>
